<div class="table-container">
    <table class="spaced-table">
        <tr>
            <th rowspan="2">ID</th>
            <th rowspan="2">Avatar</th>
            <th rowspan="2">Display Name</th>
            <th rowspan="2">Bio</th>
            <th rowspan="2">Actions</th>
            <th colspan="<?= count(${basename(__FILE__, '.phtml') . '_roles'}) ?>" dir="ltr">Roles</th>
        </tr>
        <tr>
            <?php for ($i = 0; $i < count(${basename(__FILE__, '.phtml') . '_roles'}); $i++):
                $headerRole = ${basename(__FILE__, '.phtml') . '_roles'}[$i];
                $headerRoleColor = preg_match('/^[0-9a-fA-F]{3,6}$/', $headerRole->color) ? $headerRole->color : 'cccccc';
            ?>
                <th class="role-header"
                    style="background-color: #<?= $headerRoleColor ?>;" dir="ltr">
                    <?= $headerRole->name ?>
                </th>
            <?php endfor; ?>
        </tr>
        <?php foreach (${basename(__FILE__, '.phtml') . '_accounts'} as $user): ?>
            <tr data-user-id="<?= $user->getId() ?>">
                <td class="userinfo"><?= $user->getId() ?></td>
                <td><img class="avatar" src="<?= $user->getAvatarLink() ?>"
                        onerror="this.onerror=null; this.src='<?= $user->getDefaultAvatarUrl() ?>'"
                        alt="Profile picture" loading="lazy" /></td>
                <td class="userinfo"><?= $user->getName() ?></td>
                <td class="userinfo txt-l"><a href="/cast/<?= $user->getId() ?>#bio"
                        target="_blank">Bio User
                        <?= $user->getId() ?></a></td>
                <td class="buttons-column">
                    <span class="reset-password-link"><button class="resetpasswordbtn lb-a">Reset
                            Password</button></span>
                    <a class="manage-account-link btn manageaccbtn"
                        href="/account/<?= $user->getId() ?>">Manage Account</a>
                    <span class="clear-bio-link"><button class="clearbiobtn lb-a">Clear Bio</button></span>
                    <span class="clear-avatar-link"><button class="clearavatarbtn lb-a">Clear Avatar</button></span>
                    <span class="delete-account-link"><button class="deletebtn">Delete account</button></span>
                </td>
                <?php
                $roles = ${basename(__FILE__, '.phtml') . '_roles'};
                foreach ($roles as $role):
                    $roleId = $role->getId();
                    $roleName = $role->name;
                    $roleColor = $role->color;
                    $inputId = 'role-checkbox-' . $user->getId() . '-' . $roleId;
                ?>
                    <td class="role-column"
                        style="background-color: #<?= $roleColor ?>">
                        <input type="checkbox" id="<?= $inputId ?>" aria-label="<?= $roleName ?>"
                            <?= $user->hasRole($role->name) ? 'checked' : '' ?> data-role-id="<?= $roleId ?>"
                            class="checkbox-large">
                    </td>
                <?php endforeach; ?>
            </tr>
        <?php endforeach; ?>
    </table>
</div>