<?php

/**
 * Audio Player Component
 *
 * Required variable: $audioSrc - URL to the audio file
 */

// Validate that $audioSrc is provided and valid
if (!isset($audioSrc) || empty($audioSrc) || !is_string($audioSrc)) {
    error_log(sprintf(
        'Audio player partial: Invalid $audioSrc provided (type: %s, value: %s)',
        gettype($audioSrc ?? null),
        var_export($audioSrc ?? null, true)
    ));
    // Fail silently - render nothing instead of breaking the page
    return;
}
?>
<div class="custom-audio-player">
    <button type="button" class="audio-play-btn" aria-label="Play audio" aria-pressed="false">
        <span class="play-icon"></span>
        <span class="pause-icon"></span>
    </button>
    <div class="audio-waveform" aria-hidden="true">
        <?php for ($i = 0; $i < 15; $i++): ?>
            <div class="bar"></div>
        <?php endfor; ?>
    </div>
    <audio class="audio-element" src="<?= htmlspecialchars($audioSrc, ENT_QUOTES, 'UTF-8') ?>" controls
        preload="none"></audio>
</div>